#compdef lrm
# Zsh completion script for lrm (Localization Resource Manager)
#
# Installation:
#   1. Copy this file to a directory in your $fpath (e.g., /usr/share/zsh/site-functions/_lrm)
#   2. Or add the containing directory to your fpath in ~/.zshrc:
#      fpath=(~/.zsh/completions $fpath)
#   3. Run: compinit
#   4. Restart your shell or run: exec zsh

_lrm() {
    local -a commands
    commands=(
        'validate:Validate resource files for missing keys, duplicates, and empty values'
        'stats:Display statistics about resource files and translation coverage'
        'view:View details of a specific localization key'
        'add:Add a new localization key to all language files'
        'update:Update values for an existing localization key'
        'delete:Delete a localization key from all language files'
        'export:Export resource files to CSV or JSON format'
        'import:Import translations from CSV format'
        'edit:Launch interactive TUI editor for resource files'
        'translate:Translate missing keys using AI translation providers'
        'scan:Scan source code for localization key references'
        'check:Run validation and scan together'
        'list-languages:List all available language resource files'
        'add-language:Add a new language resource file'
        'remove-language:Remove a language resource file'
        'config:Manage LRM configuration and API keys'
    )

    local -a global_opts
    global_opts=(
        '(-p --path)'{-p,--path}'[Path to Resources folder]:directory:_directories'
        '(-h --help)'{-h,--help}'[Show help information]'
        '(-v --version)'{-v,--version}'[Show version information]'
    )

    local -a format_opts
    format_opts=(
        'table:Table format (human-readable)'
        'json:JSON format (machine-readable)'
        'simple:Simple text format'
        'csv:CSV format (for export)'
        'tui:Terminal UI format (interactive)'
    )

    local -a provider_opts
    provider_opts=(
        'google:Google Cloud Translation API'
        'deepl:DeepL Translation API'
        'libretranslate:LibreTranslate (open-source)'
        'ollama:Ollama (local LLM)'
        'openai:OpenAI GPT models'
        'claude:Anthropic Claude'
        'azureopenai:Azure OpenAI'
        'azuretranslator:Azure AI Translator'
    )

    _arguments -C \
        '1: :->command' \
        '*:: :->args' \
        && return 0

    case $state in
        command)
            _describe -t commands 'lrm commands' commands
            _arguments $global_opts
            ;;
        args)
            case $words[1] in
                validate)
                    _arguments \
                        '--format[Output format]:format:->formats' \
                        '--missing-only[Show only missing translations]' \
                        $global_opts
                    case $state in
                        formats)
                            _describe -t formats 'output formats' format_opts
                            ;;
                    esac
                    ;;
                stats)
                    _arguments \
                        '--format[Output format]:format:->formats' \
                        $global_opts
                    case $state in
                        formats)
                            _describe -t formats 'output formats' format_opts
                            ;;
                    esac
                    ;;
                view)
                    _arguments \
                        '1:key name' \
                        '--show-comments[Show comments for the key]' \
                        '--format[Output format]:format:->formats' \
                        '--regex[Treat key as regex pattern]' \
                        '--sort[Sort results alphabetically]' \
                        '--no-limit[Show all matches without limit]' \
                        $global_opts
                    case $state in
                        formats)
                            _describe -t formats 'output formats' format_opts
                            ;;
                    esac
                    ;;
                add)
                    _arguments \
                        '1:key name' \
                        '*'{-l,--lang}'[Language value (code:value)]:langvalue' \
                        '--comment[Add comment]:comment' \
                        '--no-backup[Skip backup creation]' \
                        $global_opts
                    ;;
                update)
                    _arguments \
                        '1:key name' \
                        '*'{-l,--lang}'[Language value (code:value)]:langvalue' \
                        '--comment[Update comment]:comment' \
                        '(-i --interactive)'{-i,--interactive}'[Interactive mode]' \
                        '(-y --yes)'{-y,--yes}'[Skip confirmation]' \
                        '--no-backup[Skip backup creation]' \
                        $global_opts
                    ;;
                delete)
                    _arguments \
                        '1:key name' \
                        '(-y --yes)'{-y,--yes}'[Skip confirmation]' \
                        '--no-backup[Skip backup creation]' \
                        $global_opts
                    ;;
                export)
                    _arguments \
                        '(-o --output)'{-o,--output}'[Output file]:file:_files' \
                        '--format[Output format]:format:->formats' \
                        '--include-status[Include validation status column]' \
                        $global_opts
                    case $state in
                        formats)
                            _describe -t formats 'output formats' format_opts
                            ;;
                    esac
                    ;;
                import)
                    _arguments \
                        '1:CSV file:_files -g "*.csv"' \
                        '--overwrite[Overwrite existing values]' \
                        '--no-backup[Skip backup creation]' \
                        $global_opts
                    ;;
                edit)
                    _arguments $global_opts
                    ;;
                translate)
                    _arguments \
                        '--provider[Translation provider]:provider:->providers' \
                        '--target-languages[Target languages (comma-separated)]:languages' \
                        '--batch-size[Batch size for translation]:size:(5 10 20 50 100)' \
                        '--only-missing[Translate only missing keys]' \
                        '--format[Output format]:format:->formats' \
                        '--config-file[Configuration file path]:file:_files -g "*.json"' \
                        $global_opts
                    case $state in
                        providers)
                            _describe -t providers 'translation providers' provider_opts
                            ;;
                        formats)
                            _describe -t formats 'output formats' format_opts
                            ;;
                    esac
                    ;;
                scan)
                    _arguments \
                        '--source-path[Path to source code directory]:directory:_directories' \
                        '--exclude[Glob patterns to exclude (comma-separated)]:patterns' \
                        '--strict[Strict mode - only high-confidence references]' \
                        '--show-unused[Show only unused keys]' \
                        '--show-missing[Show only missing keys]' \
                        '--show-references[Show detailed reference information]' \
                        '--resource-classes[Resource class names to detect]:classes' \
                        '--localization-methods[Localization method names to detect]:methods' \
                        '--format[Output format]:format:->formats' \
                        $global_opts
                    case $state in
                        formats)
                            _describe -t formats 'output formats' format_opts
                            ;;
                    esac
                    ;;
                check)
                    _arguments \
                        '--source-path[Path to source code directory]:directory:_directories' \
                        '--exclude[Glob patterns to exclude]:patterns' \
                        '--strict[Strict mode for scanning]' \
                        '--format[Output format]:format:->formats' \
                        $global_opts
                    case $state in
                        formats)
                            _describe -t formats 'output formats' format_opts
                            ;;
                    esac
                    ;;
                list-languages)
                    _arguments \
                        '--format[Output format]:format:->formats' \
                        $global_opts
                    case $state in
                        formats)
                            _describe -t formats 'output formats' format_opts
                            ;;
                    esac
                    ;;
                add-language)
                    _arguments \
                        '(-c --culture)'{-c,--culture}'[Culture code]:code:(en es fr de it pt ja zh ko ru ar el tr nl pl cs sv)' \
                        '--base-name[Base resource file name]:basename' \
                        '--copy-from[Copy entries from specific language]:code:(en es fr de it pt ja zh ko ru ar el tr nl pl cs sv)' \
                        '--empty[Create empty language file]' \
                        '--no-backup[Skip creating backups]' \
                        '(-y --yes)'{-y,--yes}'[Skip confirmation prompts]' \
                        $global_opts
                    ;;
                remove-language)
                    _arguments \
                        '(-c --culture)'{-c,--culture}'[Culture code to remove]:code:(en es fr de it pt ja zh ko ru ar el tr nl pl cs sv)' \
                        '--base-name[Base resource file name]:basename' \
                        '(-y --yes)'{-y,--yes}'[Skip confirmation prompt]' \
                        '--no-backup[Skip creating backups]' \
                        $global_opts
                    ;;
                config)
                    local -a config_subcommands
                    config_subcommands=(
                        'set-api-key:Store an API key in the secure credential store'
                        'get-api-key:Check where an API key is configured'
                        'delete-api-key:Remove an API key from the secure credential store'
                        'list-providers:List all translation providers and their status'
                    )

                    _arguments -C \
                        '1: :->subcommand' \
                        '*:: :->subargs' \
                        && return 0

                    case $state in
                        subcommand)
                            _describe -t config-subcommands 'config subcommands' config_subcommands
                            ;;
                        subargs)
                            case $words[1] in
                                set-api-key)
                                    _arguments \
                                        '(-p --provider)'{-p,--provider}'[Translation provider]:provider:->providers' \
                                        '(-k --key)'{-k,--key}'[API key to store]:key' \
                                        $global_opts
                                    case $state in
                                        providers)
                                            _describe -t providers 'translation providers' provider_opts
                                            ;;
                                    esac
                                    ;;
                                get-api-key)
                                    _arguments \
                                        '--provider[Translation provider]:provider:->providers' \
                                        $global_opts
                                    case $state in
                                        providers)
                                            _describe -t providers 'translation providers' provider_opts
                                            ;;
                                    esac
                                    ;;
                                delete-api-key)
                                    _arguments \
                                        '(-p --provider)'{-p,--provider}'[Translation provider]:provider:->providers' \
                                        $global_opts
                                    case $state in
                                        providers)
                                            _describe -t providers 'translation providers' provider_opts
                                            ;;
                                    esac
                                    ;;
                                list-providers)
                                    _arguments $global_opts
                                    ;;
                            esac
                            ;;
                    esac
                    ;;
            esac
            ;;
    esac
}

_lrm "$@"
