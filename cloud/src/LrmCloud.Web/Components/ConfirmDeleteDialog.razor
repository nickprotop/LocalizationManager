<MudDialog @bind-Visible="_visible" Options="_dialogOptions">
    <TitleContent>
        <MudText Typo="Typo.h6">
            <MudIcon Icon="@Icons.Material.Filled.Warning" Color="Color.Error" Class="mr-2" />
            @_title
        </MudText>
    </TitleContent>
    <DialogContent>
        <MudStack Spacing="3">
            <MudText>@_message</MudText>

            @if (_items.Any())
            {
                <MudPaper Class="pa-3" Elevation="0" Style="background-color: var(--mud-palette-surface); max-height: 200px; overflow-y: auto;">
                    <MudList T="string" Dense="true">
                        @foreach (var item in _items.Take(10))
                        {
                            <MudListItem T="string" Icon="@Icons.Material.Filled.Remove">
                                <MudText Typo="Typo.body2">@item</MudText>
                            </MudListItem>
                        }
                        @if (_items.Count > 10)
                        {
                            <MudListItem T="string">
                                <MudText Typo="Typo.caption" Color="Color.Secondary">
                                    ...and @(_items.Count - 10) more
                                </MudText>
                            </MudListItem>
                        }
                    </MudList>
                </MudPaper>
            }

            <MudAlert Severity="Severity.Warning" Dense="true">
                This action cannot be undone.
            </MudAlert>
        </MudStack>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Close">Cancel</MudButton>
        <MudButton Color="Color.Error" Variant="Variant.Filled" OnClick="Confirm">
            Delete
        </MudButton>
    </DialogActions>
</MudDialog>

@code {
    [Parameter]
    public EventCallback OnConfirmed { get; set; }

    private bool _visible;
    private string _title = "Confirm Delete";
    private string _message = "Are you sure you want to delete this item?";
    private List<string> _items = new();

    private readonly DialogOptions _dialogOptions = new()
    {
        MaxWidth = MaxWidth.Small,
        FullWidth = true,
        CloseOnEscapeKey = true
    };

    public void Open(string? title = null, string? message = null, List<string>? items = null)
    {
        _title = title ?? "Confirm Delete";
        _message = message ?? "Are you sure you want to delete this item?";
        _items = items ?? new List<string>();
        _visible = true;
        StateHasChanged();
    }

    private void Close()
    {
        _visible = false;
    }

    private async Task Confirm()
    {
        await OnConfirmed.InvokeAsync();
        Close();
    }
}
